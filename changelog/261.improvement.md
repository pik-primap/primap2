Added support for and required pandas 2.2.

Switched accelerated filling functions from bottleneck to numbagg.
